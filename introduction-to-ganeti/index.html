<!DOCTYPE html>
<html lang="en"  dir="auto" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to Ganeti - blog.bott.im</title>
<meta property="og:title" content="Introduction to Ganeti - blog.bott.im">
<link rel="stylesheet" href="/css/style.css?v=1704227782">
<script src="/js/scripts.js?v=1704227782"></script>

<script>
  if ('serviceWorker' in navigator)  {
    navigator.serviceWorker.getRegistrations().then(function(registrations) {
      for(let registration of registrations) {
        registration.unregister();
      }
    });
  }
</script>

<meta name="description" content="Ganeti is a virtualisation cluster solution ranging from few to hundreds of VMs.">
<link rel="canonical" href="https://blog.bott.im/introduction-to-ganeti" />
<meta name="generator" content="Eleventy v2.0.1">

<link rel="icon" href="/favicon.ico" sizes="any">
<link rel="icon" href="/favicon.svg" type="image/svg+xml">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="manifest" href="/manifest.webmanifest">

<link rel="alternate" type="application/rss+xml"  title="blog.bott.im RSS feed (excerpts)" href="/excerpts.xml" />
<link rel="alternate" type="application/rss+xml"  title="blog.bott.im RSS feed (full articles)" href="/full.xml" />
<link rel="alternate" type="application/json" title="blog.bott.im JSON feed (excerpts)" href="/excerpts.json">
<link rel="alternate" type="application/json" title="blog.bott.im JSON feed (full articles)" href="/full.json">
<meta property="og:url" content="https://blog.bott.im/introduction-to-ganeti/">
<meta property="og:type" content="article">
<meta property="og:image" content="https://blog.bott.im/images/share-1200x600.jpg">
<meta property="twitter:image" content="https://blog.bott.im/images/share-1200x600.jpg">
<meta property="twitter:card" content="summary_large_image">
<link rel="me" href="https://chaos.social/@rbo_ne" title="@rbo_ne@chaos.social" />
<link rel="me" href="https://pixelfed.de/@rbo_ne" title="@rbo_ne@pixelfed.de" />

<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "Introduction to Ganeti",
        "image": ["https://blog.bott.im/images/share-1200x600.jpg"],
        "author": {
            "@type": "Person",
            "name": "Rudolph Bott"
        },
        "mainEntityOfPage": "https://blog.bott.im/introduction-to-ganeti/",
        "datePublished": "2024-01-01T00:00:00.000Z",
        "description": "Ganeti is a virtualisation cluster solution ranging from few to hundreds of VMs."
    }
</script>


  </head>
  <body>
    <a href="#main" id="skipToMain" class="skip-link">Skip to main content</a>
<header class="header">
  <input class="menu-btn" type="checkbox" id="menu-btn">
<label class="hamburger" tabindex="0" for="menu-btn">
  <span></span>
</label>
  <div class="main-nav">
  <div class="site-logo">
    <a href="/" title="blog.bott.im - Main page">
      
  <img src="/images/logo.svg" alt="Site logo" />
  <span class="title">blog.bott.im</span>

    </a>
  </div>
  <ul class="site-links">
  
  <li>
    <a href="/about/">
      About
    </a>
  </li>
  
  <li>
    <a href="/archive/">
      Archive
    </a>
  </li>
  
  <li>
    <a href="/subscribe/">
      Subscribe
    </a>
  </li>
  
  </ul>
</div>

  <div class="theme-switcher" tabindex="0">
  <svg class="dark-toggle" viewBox="0 0 455 455" xmlns="http://www.w3.org/2000/svg">
<title>Dark mode switch icon</title>
<polygon points="320.18 162.7 280.63 171.05 307.72 201.05 303.44 241.24 340.34 224.75 377.24 241.24 372.96 201.05 400.05 171.05 360.5 162.7 340.34 127.67"/>
<polygon points="440 325.68 414.09 320.21 400.88 297.25 387.68 320.21 361.77 325.68 379.51 345.33 376.71 371.66 400.88 360.86 425.06 371.66 422.25 345.33"/>
<path d="m218 227.5c0-89.167 51.306-166.34 126-203.64-30.557-15.26-65.022-23.86-101.5-23.86-125.64 0-227.5 101.86-227.5 227.5s101.86 227.5 227.5 227.5c36.478 0 70.943-8.6 101.5-23.86-74.694-37.302-126-114.47-126-203.64z"/>
</svg>

  <svg class="light-toggle" viewBox="0 0 612 612" xmlns="http://www.w3.org/2000/svg"><title>Light mode switch icon</title><path d="m306 149.34c-86.382 0-156.66 70.278-156.66 156.66 0 86.382 70.278 156.66 156.66 156.66s156.66-70.278 156.66-156.66c0-86.384-70.278-156.66-156.66-156.66z"/><path d="m274.19 117.28h63.612c5.032 0 9.356-2.101 11.863-5.763 2.508-3.662 2.9-8.453 1.079-13.146l-34.999-90.112c-2.789-7.184-7.305-8.256-9.749-8.256s-6.96 1.073-9.749 8.255l-35 90.114c-1.821 4.692-1.427 9.482 1.079 13.145 2.507 3.663 6.832 5.763 11.864 5.763z"/><path d="m337.81 494.72h-63.612c-5.032 0-9.357 2.102-11.863 5.764-2.506 3.663-2.9 8.453-1.079 13.145l34.999 90.114c2.789 7.182 7.305 8.254 9.749 8.254s6.96-1.072 9.749-8.254l34.999-90.115c1.821-4.69 1.429-9.48-1.079-13.144-2.507-3.662-6.831-5.764-11.863-5.764z"/><path d="m127.54 190.82c2.412 5.477 7.028 8.746 12.348 8.746 3.644 0 7.257-1.608 10.174-4.526l44.981-44.98c3.558-3.558 5.13-8.102 4.312-12.466-0.819-4.362-3.928-8.028-8.532-10.056l-88.467-38.973c-2.233-0.983-4.336-1.482-6.25-1.482-3.201 0-5.959 1.415-7.568 3.882-1.357 2.081-2.454 5.747 0.031 11.389l38.971 88.466z"/><path d="m484.46 421.18c-2.412-5.477-7.027-8.746-12.346-8.746-3.645 0-7.259 1.609-10.177 4.527l-44.981 44.98c-3.558 3.559-5.13 8.104-4.312 12.466s3.929 8.028 8.532 10.055l88.466 38.974c2.233 0.983 4.336 1.482 6.25 1.482 3.201 0 5.959-1.417 7.568-3.882 1.358-2.083 2.455-5.748-0.03-11.389l-38.97-88.467z"/><path d="m461.94 195.04c2.918 2.918 6.532 4.526 10.176 4.526 5.319 0 9.934-3.269 12.348-8.746l38.972-88.465c2.486-5.643 1.389-9.308 0.031-11.389-1.609-2.467-4.367-3.882-7.568-3.882-1.914 0-4.017 0.499-6.251 1.483l-88.466 38.97c-4.604 2.029-7.715 5.694-8.532 10.057-0.818 4.363 0.754 8.908 4.312 12.466l44.978 44.98z"/><path d="m150.06 416.96c-2.918-2.918-6.532-4.527-10.177-4.527-5.319 0-9.934 3.269-12.346 8.746l-38.972 88.465c-2.486 5.643-1.389 9.308-0.031 11.39 1.609 2.466 4.368 3.882 7.568 3.882 1.914 0 4.017-0.499 6.251-1.484l88.466-38.972c4.604-2.028 7.715-5.694 8.532-10.056 0.818-4.362-0.753-8.907-4.312-12.466l-44.979-44.978z"/><path d="m603.74 296.25-90.111-34.996c-1.942-0.755-3.896-1.137-5.806-1.137-7.593 0-13.104 5.921-13.104 14.078l1e-3 63.613c0 8.157 5.511 14.078 13.104 14.078 1.912 0 3.866-0.382 5.806-1.136l90.112-34.999c7.182-2.79 8.254-7.306 8.254-9.751 0-2.443-1.075-6.961-8.256-9.75z"/><path d="m104.17 351.89c7.594 0 13.106-5.921 13.106-14.078v-63.613c0-8.157-5.511-14.078-13.106-14.078-1.912 0-3.864 0.382-5.805 1.136l-90.113 34.998c-7.182 2.789-8.255 7.305-8.255 9.75 0 2.444 1.072 6.96 8.255 9.752l90.111 34.996c1.942 0.754 3.895 1.137 5.807 1.137z"/></svg>
</div>
</header>

    <div id="main" class="container">
      

<div class="reading-progress-bar"></div>


<article class="single-article">

  

  <header>
    <h1>Introduction to Ganeti</h1>
  </header>
  <div class="top-meta">
  <time>1 Jan 2024</time>
  <span class="separator">•</span>  
  <span data-tooltip="941 words" class="tooltip-bottom reading-time">5 min read</span>
</div>
  
<div class="notice">
  <p >
  
    <b>Disclaimer:</b> Being one of the maintainers of the Ganeti project, some views might be biased here :-)
  
  </p>
</div>

  <p>During the next weeks and months I will publish a series of blog posts about <a href="https://ganeti.org">Ganeti</a>. It is a virtual machine cluster management solution which started as an internal project at Google and saw its first public release in August 2007. With the beta release of Ganeti 3.0 in June 2020, development has officially been taken over by the Ganeti Community from Google.</p>
<h2 id="but-what-does-it-actually-do">But what does it actually do?</h2>
<p>Ganeti can be used on a single system to spawn local VMs using KVM or Xen (think of an alternative to libvirt). However, its strength is running in clustered environments, operating dozens or even hundreds of VMs across many physical nodes.</p>
<p>To achieve this, Ganeti builds upon existing solutions. VM Storage can be local or replicated (using DRBD, Ceph, Gluster or custom solutions), VM connectivity can be implemented using linux bridges, Open vSwitch or in a routed fashion. Virtualisation builds upon KVM, Xen (both HVM and PVM) or LXC (which is still present in the codebase, but not maintained as of now). Communication between physical nodes is handled through SSH and HTTP APIs.
The primary way of managing/interacting with Ganeti are versatile CLI commands, but there is also a REST API available for integration into existing automation solutions.</p>
<h2 id="does-it-do-high-availability">Does it do High Availability?</h2>
<p>That’s a definitive maybe. First of all, you need to select a storage backend that supports replication of some sorts. Currently that would be either DRBD, RBD (Ceph) or GlusterFS. Ganeti also supports a file based approach where Ganeti assumes that replication of these files is handled outside of Ganeti (e.g. a shared NFS mount). With either of these storage backends in place you can live migrate VMs between nodes and also start them on another node if the formerly primary node unexpectedly dies. While Ganeti will restart a crashed VM (through a periodically running maintenance process) on its original node, it will not automatically switch a VM to a backup node. This must be done manually by a human. You can use the tool harep that ships with Ganeti for a more automated approach, but I have never used that so far.</p>
<p>For all scenarios I have encountered it was enough to manually start VMs on other nodes after a failure because there was additional redundancy on the VM level (e.g. multiple backends together with HA loadbalancers using VRRP,  anycast etc.). Hence, “eventual availability” was more than suitable.</p>
<h2 id="resource-allocation">Resource Allocation</h2>
<p>While you can allocate VMs manually across your cluster nodes, Ganeti can and should do that automatically for you. This will ensure that your cluster always maintains a N+1 state where one node may fail at any time and the remaining nodes have enough spare resources to host the additional workload. You can also tag your VMs so that multiple instances of the same application do not end up on the same physical node.
Cluster/Node Maintenance
Using the CLI or the API you can easily drain a node and (live) migrate all running instances to other nodes or rebalance the entire cluster after maintenance work. There is also tooling available that helps you plan maintenance of nodes.</p>
<h2 id="os-providers">OS Providers</h2>
<p>How to set up new VMs, you may ask? Ganeti has a concept of so called OS providers. Most widely used is probably the deboostrap OS provider (also available as a package on Debian) which creates Debian or Ubuntu installations using the debootstrap tool and custom hooks. There are also many community providers available which make use of e.g. prebuilt images. You may also use the so-called “no-op OS provider” (also available as Debian package) which tells Ganeti to leave your VM alone and you can e.g. boot/install via ISO image or PXE boot.</p>
<h2 id="what-does-ganeti-suck-at">What does Ganeti suck at?</h2>
<p>As of the time of writing, KVM VMs are stuck with the rather old <code>pc</code> machine type and also do not support UEFI booting. This will sooner or later impose problems with Windows guest systems. There is also no official upstream GUI/web interface available (however, there are third party options). The official documentation works but looks a bit dated,has a sometimes confusing structure and is missing easy-to-follow getting-started documentation (although there is work in that direction on the way). OTOH the man pages are a very good source of information. While the larger part of the codebase is written in Python (which is easy to read and understand) there are also Haskell parts, which are not that accessible to the broader public (could be rephrased to: I suck at Haskell).</p>
<h2 id="why-should-i-use-ganeti">Why should I use Ganeti?</h2>
<p>There are packages available for Debian, Ubuntu, GNU Guix and also RPM-based distributions. Especially the official Debian packages are well maintained and it is very easy to set up an entire cluster with many nodes without using any third party repositories/software. However, this will be covered in a different blog post 🙂
Upgrades of Ganeti clusters are possible and usually work flawlessly. Ganeti itself does not get in the way of your VM operations. It is very robust and can recover from many error states by itself.
While RBD/Ceph or Gluster backends require the additional installation/configuration of services outside of Ganeti, DRBD is fully managed. Ganeti will take care of all DRBD-related operations and provide you with redundant VMs at no additional operative cost. Ganeti powers well-known infrastructures like Wikimedia, Tor Project, Debian or ICANN. It is also in use at various universities and many private companies and you can interact with developers and the community using mailing lists, IRC or Github issues.</p>

</article>

<div class="author-info">
  <p>Originally published on <time>1 January 2024</time> by Rudolph Bott</p>
</div>
<div class="bottom-meta">
  
<div class="post-tags">

  <p>Tagged as:</p>
  <ul>
  
    <li>
      <a title="Articles tagged as 'ganeti'" href="/tag/ganeti/">ganeti</a>
    </li>
  
  </ul>

</div>

  
  <div class="share-buttons">
    <p>Share this article:</p>

    
      <div class="mastodon-share-dialog">
  <p id="which-instance-label"><b>To which instance?</b></p>
  <p>Clicking Share will open a new browser tab. Make sure your browser permits websites to open new tabs.</p>
  <p>You will be able to modify your status contents before submitting.</p>
  <p>Example: <code>mastodon.social</code></p>
  <form class="mastodon-share-form">
    <input type="text" class="instance-url-input"
    aria-labelledby="which-instance-label" />
    <input class="share-form-submit" type="submit" value="Share" disabled />
  </form>
  <p><span class="close-link" tabindex="0">Close this window</span></p>
</div>

    

    
    <ul>

      
      <li>
        <div data-tooltip="Share on Mastodon - opens prompt window" class="mastodon" tabindex="0">
          <svg role="img" viewBox="0 0 61 65" xmlns="http://www.w3.org/2000/svg"><title>Mastodon icon</title><path class="fillable" d="m60.754 14.39c-0.9396-6.984-7.0266-12.488-14.242-13.554-1.2174-0.18021-5.8298-0.83607-16.514-0.83607h-0.0798c-10.688 0-12.98 0.65585-14.198 0.83607-7.0147 1.037-13.421 5.9825-14.975 13.049-0.74757 3.4802-0.82735 7.3385-0.68847 10.878 0.19797 5.0755 0.23638 10.142 0.69734 15.197 0.31867 3.3577 0.87458 6.6886 1.6636 9.9678 1.4774 6.0563 7.458 11.096 13.317 13.152 6.2733 2.1443 13.02 2.5003 19.484 1.0281 0.7111-0.1654 1.4134-0.3574 2.1068-0.5761 1.5719-0.4992 3.4128-1.0576 4.7661-2.0384 0.0186-0.0138 0.0338-0.0316 0.0445-0.052 0.0108-0.0205 0.0168-0.0431 0.0176-0.0662v-4.8982c-4e-4 -0.0216-0.0055-0.0428-0.0151-0.0622-0.0096-0.0193-0.0234-0.0363-0.0404-0.0496s-0.0368-0.0226-0.0579-0.0273c-0.021-0.0047-0.0429-0.0046-0.0639 2e-4 -4.1416 0.9892-8.3856 1.485-12.644 1.4772-7.3279 0-9.2988-3.4772-9.8631-4.9248-0.4537-1.2511-0.7418-2.5562-0.8569-3.882-0.0012-0.0222 0.0029-0.0445 0.0119-0.0649 9e-3 -0.0203 0.0227-0.0383 0.04-0.0524s0.0376-0.024 0.0594-0.0287c0.0218-0.0048 0.0444-0.0043 0.066 0.0013 4.0725 0.9824 8.2473 1.4782 12.437 1.4771 1.0075 0 2.0122 0 3.0198-0.0266 4.2135-0.1182 8.6546-0.3338 12.8-1.1433 0.1034-0.0207 0.2069-0.0384 0.2955-0.065 6.539-1.2556 12.762-5.1966 13.394-15.176 0.0236-0.3929 0.0827-4.1153 0.0827-4.523 0.0029-1.3856 0.4462-9.829-0.065-15.017z"/><path class="fillable-2" d="m50.394 22.237v17.351h-6.8758v-16.84c0-3.5452-1.4774-5.3532-4.4825-5.3532-3.3035 0-4.9582 2.1389-4.9582 6.3636v9.2174h-6.8344v-9.2174c0-4.2247-1.6577-6.3636-4.9612-6.3636-2.9873 0-4.4795 1.808-4.4795 5.3532v16.84h-6.8729v-17.351c0-3.5452 0.9052-6.3616 2.7155-8.4493 1.8675-2.0828 4.317-3.1522 7.3575-3.1522 3.5192 0 6.1785 1.353 7.9514 4.0562l1.7108 2.8716 1.7138-2.8716c1.7729-2.7032 4.4322-4.0562 7.9455-4.0562 3.0376 0 5.4871 1.0694 7.3604 3.1522 1.8084 2.0857 2.7116 4.9022 2.7096 8.4493z"/></svg>

        </div>
      </li>
      

      

      

      

      

      

    
    <ul>

      

      
      <li>
        <a target="_blank" rel="noopener noreferrer" data-tooltip="Share on Twitter - opens a new tab" rel="noopener noreferrer" href="https://twitter.com/intent/tweet/?text=Introduction to Ganeti&amp;url=https://blog.bott.im/introduction-to-ganeti/" class="twitter">
          <svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>Twitter icon</title><path class="fillable" d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"></path></svg>
        </a>
      </li>
      

      

      

      

      

    
    <ul>

      

      

      

      

      
      <li>
        <a target="_blank" rel="noopener noreferrer" data-tooltip="Share on Hacker News - opens a new tab" rel="noopener noreferrer" href="https://news.ycombinator.com/submitlink?u=https://blog.bott.im/introduction-to-ganeti/&amp;t=Introduction to Ganeti" class="hackernews">
          <svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><title>Hacker News icon</title><path class="fillable" d="M124 91h51l81 162 81-164h51L276 293v136h-40V293z"></path></svg>
        </a>
      </li>
      

      

    
    <ul>

      

      

      

      

      

      
      <li>
        <div class="clipboard" rel="noopener noreferrer" data-tooltip="Copy article URL to clipboard" tabindex="0">
          <svg role="img" viewBox="0 0 115.77 122.88" xml:space="preserve" xmlns="http://www.w3.org/2000/svg"><title>Copy to clipboard icon</title><path class="fillable" d="m89.62 13.96v7.73h12.2v0.02c3.85 0.01 7.34 1.57 9.86 4.1 2.5 2.51 4.06 5.98 4.07 9.82h0.02v73.3h-0.02c-0.01 3.84-1.57 7.33-4.1 9.86-2.51 2.5-5.98 4.06-9.82 4.07v0.02h-61.73v-0.02c-3.84-0.01-7.34-1.57-9.86-4.1-2.5-2.51-4.06-5.98-4.07-9.82h-0.02v-16.43h-12.2v-0.02c-3.84-0.01-7.34-1.57-9.86-4.1-2.5-2.51-4.06-5.98-4.07-9.82h-0.02v-64.62h0.02c0.01-3.85 1.58-7.34 4.1-9.86 2.51-2.5 5.98-4.06 9.82-4.07v-0.02h61.73v0.02c3.85 0.01 7.34 1.57 9.86 4.1 2.5 2.51 4.06 5.98 4.07 9.82h0.02v0.02zm-10.58 7.73v-7.75h0.02c0-0.91-0.39-1.75-1.01-2.37-0.61-0.61-1.46-1-2.37-1v0.02h-61.73v-0.02c-0.91 0-1.75 0.39-2.37 1.01-0.61 0.61-1 1.46-1 2.37h0.02v64.62h-0.02c0 0.91 0.39 1.75 1.01 2.37 0.61 0.61 1.46 1 2.37 1v-0.02h12.2v-46.28h0.02c0.01-3.85 1.58-7.34 4.1-9.86 2.51-2.5 5.98-4.06 9.82-4.07v-0.02h38.94zm26.14 87.23v-73.29h0.02c0-0.91-0.39-1.75-1.01-2.37-0.61-0.61-1.46-1-2.37-1v0.02h-61.73v-0.02c-0.91 0-1.75 0.39-2.37 1.01-0.61 0.61-1 1.46-1 2.37h0.02v73.3h-0.02c0 0.91 0.39 1.75 1.01 2.37 0.61 0.61 1.46 1 2.37 1v-0.02h61.73v0.02c0.91 0 1.75-0.39 2.37-1.01 0.61-0.61 1-1.46 1-2.37h-0.02v-0.01z" /></svg>
        </div>
      </li>
      

    
    </ul>
  </div>

</div>
<div class="post-navigation">
  <ul>
    <li>
      
    </li>
    <li>
      
    </li>
  </ul>
</div>

<div class="scroll-up-arrow" tabindex="0">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000"><g><path class="fillable" d="M990,699.9c0,8.1,0,16.3-8.1,24.4c-16.3,16.3-40.7,16.3-56.9,0L502,350.2L79.1,732.4c-16.3,16.3-40.7,16.3-56.9,0c-16.3-16.3-16.3-40.7,0-56.9l447.3-406.6c24.4-16.3,40.7-16.3,56.9-8.1l447.3,406.6C981.9,675.5,990,691.8,990,699.9z"></path></g></svg>

</div>

      <footer class="footer">
  <div class="container">
    <div class="links">
  <ul>

  <li>
    <a href="/about/">
      <span>About</span>
    </a>
  </li>

  <li>
    <a href="/archive/">
      <span>Archive</span>
    </a>
  </li>

  <li>
    <a href="/subscribe/">
      <span>Subscribe</span>
    </a>
  </li>

</ul>    
  
<ul>

</ul>

</div>
    <div class="copyright">
  &copy; 2024-2024 <a href="https://blog.bott.im/">Rudolph Bott</a><br>
  Powered by <a href="https://11ty.dev">Eleventy</a><br>
  Template: <a href="https://github.com/lwojcik/eleventy-template-bliss">Bliss</a> by <a href="https://offbeatbits.com">Offbeat Bits</a>
</div>
  </div>
</footer>

    </div>
  </body>
</html>