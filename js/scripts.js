const themeKey="theme",darkSetting="dark",lightSetting="light",htmlElement=document.querySelector("html"),setTheme=e=>{const t=document.querySelector(".theme-switcher"),o=["light","dark"],[s,n]="light"===e?["dark","light"]:["light","dark"];o.includes(e)&&(htmlElement.classList.remove(s),t.classList.remove(s),htmlElement.classList.add(n),t.classList.add(n))},scrollToTop=()=>{window.scroll({top:0,left:0,behavior:window.matchMedia("(prefers-reduced-motion)").matches?"auto":"smooth"})},getScrollPercent=()=>{const e=document.documentElement,t=document.body;return(e.scrollTop||t.scrollTop)/((e.scrollHeight||t.scrollHeight)-e.clientHeight)*100};window.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector("html");e.classList.remove("no-js");const t=()=>{const t=e.classList.contains("dark")?"light":"dark";setTheme(t);try{localStorage.setItem("theme",t)}catch{return!1}},o=window.matchMedia("(prefers-color-scheme: dark)");o.matches&&setTheme("dark"),o.addEventListener("change",(e=>{const t=e.matches?"dark":"light";setTheme(t)}));const s=localStorage.getItem("theme")||null;s&&setTheme(s);const n=document.querySelector(".theme-switcher");n.addEventListener("click",t),n.addEventListener("keyup",(e=>{e.preventDefault(),13===e.keyCode&&t()}));const r=document.querySelector(".menu-btn");document.querySelector(".hamburger").addEventListener("keyup",(e=>{if(e.preventDefault(),13===e.keyCode){const{checked:e}=r;r.checked=!e}})),r.addEventListener("change",(()=>{document.querySelector("body").classList.toggle("no-scrollbar");const e=document.getElementById("main").style;r.checked?e.display="none":e.display="block"}));const c=document.querySelector(".reading-progress-bar");if(c){const e=()=>{const e=getScrollPercent();c.style.width=e+"%"};window.addEventListener("scroll",e),e()}const l=document.querySelector(".scroll-up-arrow");l&&(l.addEventListener("click",scrollToTop),l.addEventListener("keyup",(e=>{e.preventDefault(),13===e.keyCode&&scrollToTop()}))),document.addEventListener("scroll",(()=>{const t=e.scrollTop;if(l){3*t>=window.innerHeight?l.classList.add("visible"):l.classList.remove("visible")}}));const a=".year-heading",d=document.querySelectorAll(".archive .list"),i=document.querySelectorAll(`.archive ${a}`),u=e=>{const t=e.target.closest(a),o=t.getAttribute("id").split("-")[1];t.classList.toggle("hidden"),document.getElementsByClassName(`posts-${o}`)[0].classList.toggle("hidden")},m=e=>{e.preventDefault(),13===e.keyCode&&u(e)};if(d&&d.length>0){for(const e of d)e.classList.add("hidden");for(const e of i)e.classList.add("clickable","hidden"),e.addEventListener("click",u),e.addEventListener("keyup",m);d[0].classList.remove("hidden"),i[0].classList.remove("hidden")}const h=document.querySelector(".jump-to-page-form"),v=document.querySelector(".page-number-input"),y=document.querySelector(".jump-button"),p=()=>{y.removeAttribute("disabled")};if(h){let e;const t=parseInt(v.value),o=parseInt(document.querySelector(".total-pages").innerHTML),s=e=>{const t=parseInt(e)||e;return t>0&&t<=o&&t.toString().length<=o.toString().length},n=e=>(parseInt(e)||e)!==t,r=()=>{const e=parseInt(v.value);s(e)&&(e=>{const t=window.location.href.split(/\/[0-9]+\//)[0].replace(/\/+$/,""),o=1===e?t:`${t}/${e}`;window.location.href=o})(e)};v.addEventListener("focus",(t=>{e=parseInt(t.currentTarget.value),v.value=""})),v.addEventListener("blur",(()=>{v.value||(v.value=e)})),v.addEventListener("input",(e=>{const t=e.currentTarget.value,o=s(t),r=n(t);if(o&&r)p();else if(y.setAttribute("disabled",""),r){const e=t.slice(0,-1);v.value=e,e&&p()}})),h.addEventListener("submit",(e=>{e.preventDefault(),r()}))}const g=e.querySelector(".share-buttons .mastodon-share-form"),L=e.querySelector(".share-buttons .mastodon"),b=e.querySelector(".share-buttons .mastodon-share-dialog"),k=e.querySelector(".mastodon-share-dialog .close-link"),S=e.querySelector(".mastodon-share-dialog .instance-url-input"),f=e.querySelector(".mastodon-share-dialog .share-form-submit");if(b){const t=()=>{document.querySelector("body").classList.add("no-scrollbar"),b.classList.add("visible"),S.focus(),window.innerWidth>=768&&document.querySelector("body").classList.remove("no-scrollbar")},o=()=>{document.querySelector("body").classList.remove("no-scrollbar"),b.classList.remove("visible"),S.blur()};S.addEventListener("input",(e=>{const t=e.currentTarget.value;!!/^[a-zA-Z0-9\-.]+\.[a-zA-Z]{2,}(\/\S*)?$/.test(t)?f.removeAttribute("disabled"):f.setAttribute("disabled","")})),g.addEventListener("submit",(t=>{t.preventDefault();const o=window.location.href,s=e.querySelector("article h1").innerHTML,n=S.value;window.open("https://"+n+"/share?text="+encodeURIComponent(s)+" "+encodeURIComponent(o),"_blank")})),k.addEventListener("click",o),L&&(L.addEventListener("click",t),L.addEventListener("keyup",(e=>{13===e.keyCode&&t()})))}const E=e.querySelector(".share-buttons .clipboard");if(E){const e=async()=>{try{await navigator.clipboard.writeText(location.href),E.dataset.tooltip="Copied!"}catch(e){console.error("Failed to copy: ",e)}};E.addEventListener("click",e),E.addEventListener("keyup",(t=>{13===t.keyCode&&e()}))}}));